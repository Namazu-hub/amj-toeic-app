<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>TOEIC 550 Mastery Pro</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <nav>
        <button onclick="showView('study')" id="nav-study" class="active">暗記</button>
        <button onclick="showView('test')" id="nav-test">単語テスト</button>
        <button onclick="showView('grammar')" id="nav-grammar">文法問題</button>
        <button onclick="showView('list')" id="nav-list">一覧</button>
    </nav>

    <div id="study" class="view active">
        <div class="selector-group">
            <select id="study-genre" onchange="resetStudy()">
                <option value="全ジャンル">全ジャンル</option>
                <option value="基礎">基礎</option>
                <option value="オフィス">オフィス</option>
                <option value="技術">技術（AMJ対策）</option>
                <option value="熟語">熟語</option>
            </select>
        </div>
        <div class="card" onclick="toggleFlip()">
            <div id="study-tag" class="tag">CAT</div>
            <div class="audio-btn" onclick="handleSpeak(event, 'study')">🔊</div>
            <div id="study-en" class="en">Word</div>
            <div id="study-jp" class="jp hidden">意味</div>
        </div>
        <div id="study-count">0 / 0</div>
        <div style="margin-top:20px; display:flex; gap:10px; justify-content:center;">
            <button class="main-btn" style="background:#dadce0; color:#3c4043; width:45%;" onclick="prevCard()">前へ</button>
            <button class="main-btn" style="width:45%;" onclick="nextCard()">次へ</button>
        </div>
    </div>

    <div id="test" class="view">
        <div id="test-start-screen">
            <h2>単語 4択テスト</h2>
            <div class="selector-group">
                <select id="test-genre">
                    <option value="全ジャンル">全ジャンル</option>
                    <option value="基礎">基礎</option>
                    <option value="オフィス">オフィス</option>
                    <option value="技術">技術（AMJ対策）</option>
                    <option value="熟語">熟語</option>
                </select>
            </div>
            <button class="main-btn" onclick="startTest()">テスト開始</button>
        </div>
        <div id="quiz-area" class="hidden">
            <div class="test-progress-container">
                <div id="test-progress-bar" class="test-progress-fill" style="width: 0%;"></div>
            </div>
            <div class="card" style="cursor:default; min-height:150px;">
                <div id="quiz-tag" class="tag">CAT</div>
                <div class="audio-btn" onclick="handleSpeak(event, 'test')">🔊</div>
                <div id="quiz-en" class="en">Question</div>
            </div>
            <div class="options" id="options"></div>
        </div>
        <div id="test-result" class="hidden">
            <h3 id="result-score"></h3>
            <button class="main-btn" onclick="showView('test')">もう一度</button>
        </div>
    </div>

    <div id="grammar" class="view">
        <div id="grammar-start-screen">
            <h2>文法 Part 5 形式</h2>
            <div class="selector-group">
                <select id="grammar-genre">
                    <option value="全ジャンル">全ジャンル</option>
                    <option value="名詞">名詞</option>
                    <option value="副詞">副詞</option>
                    <option value="比較級">比較級</option>
                    <option value="受動態">受動態</option>
                    <option value="前置詞">前置詞</option>
                </select>
            </div>
            <button class="main-btn" onclick="startGrammarTest()">テスト開始</button>
        </div>
        <div id="grammar-quiz-area" class="hidden">
            <div class="card" style="cursor:default; min-height:180px;">
                <div id="grammar-tag" class="tag">Grammar</div>
                <div id="grammar-sentence" class="en" style="font-size:18px;">Sentence</div>
            </div>
            <div class="options" id="grammar-options"></div>
            <div id="grammar-translation" class="translation-area hidden"></div>
        </div>
        <div id="grammar-result" class="hidden">
            <h3 id="grammar-result-score"></h3>
            <button class="main-btn" onclick="showView('grammar')">もう一度</button>
        </div>
    </div>

    <div id="list" class="view">
        <div class="selector-group">
            <select id="list-genre" onchange="renderList()">
                <option value="全ジャンル">全ジャンルを表示</option>
                <option value="基礎">基礎</option>
                <option value="オフィス">オフィス</option>
                <option value="技術">技術（AMJ対策）</option>
                <option value="熟語">熟語</option>
            </select>
        </div>
        <div class="list-card">
            <table>
                <thead><tr><th>単語</th><th>意味</th><th>統計（率/習得）</th></tr></thead>
                <tbody id="list-body"></tbody>
            </table>
        </div>
        <div style="margin-top:20px;">
            <button onclick="exportData()">記録保存</button> 
            <button onclick="importData()">復元</button>
        </div>
    </div>

    <script src="js/words-data.js"></script>
    <script src="js/grammar-data.js"></script>
    <script src="js/audio.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/view-router.js"></script>
    <script src="js/main-logic.js"></script>
</body>
</html>